# 00. 데이터 로드

## 입력 파일

```
input_merged_datas/{회사명}/result_YYYY_vXX_YYYYMMDD_HHMMSS.json
```

## 파일 형식

```json
{
  "tot": 675,
  "data": [
    {
      "데이터소스": "분개장",
      "손익/재무구분": "PL",
      "손익분류": "매출",
      "정렬순서": 1,
      "계정과목": "의료수입",
      "계정코드": "42000",
      "증빙유형": 88,
      "거래처명": "국민카드",
      "월": "01",
      "순액": 1500000,
      ...
    },
    ...
  ]
}
```

## 로드 코드

```python
import json
import pandas as pd
from pathlib import Path

def load_result_data(company_name: str) -> pd.DataFrame:
    """회사별 가장 최신 result_*.json 로드"""

    base_dir = Path(__file__).parent.parent
    company_dir = base_dir / "input_merged_datas" / company_name

    # 가장 최신 result 파일 찾기
    result_files = list(company_dir.glob("result_*.json"))
    if not result_files:
        raise FileNotFoundError(f"No result files in {company_dir}")

    latest_file = max(result_files, key=lambda f: f.stem.split("_")[-1])

    # JSON 로드
    with open(latest_file, 'r', encoding='utf-8') as f:
        raw = json.load(f)

    df = pd.DataFrame(raw['data'])
    print(f"로드 완료: {len(df)}건 from {latest_file.name}")

    return df
```

## 필수 컬럼 검증

```python
REQUIRED_COLUMNS = [
    '데이터소스', '손익/재무구분', '손익분류', '정렬순서',
    '계정과목', '계정코드', '증빙유형', '전표유형구분',
    '거래처명', '거래처코드', '월', '년도', '순액'
]

def validate_columns(df: pd.DataFrame) -> bool:
    missing = set(REQUIRED_COLUMNS) - set(df.columns)
    if missing:
        raise ValueError(f"Missing columns: {missing}")
    return True
```

## 출력

- `pd.DataFrame` 객체
- 메타데이터: 건수, 파일명, 로드 시각
