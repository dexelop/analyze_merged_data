# 출력 데이터 스펙

## 파일 위치

```
output/{company}/
├── 요약.xlsx          ← 핵심 출력
├── 요약.json          ← 동일 내용 JSON
├── 거래처별_증빙유형_전표구분_신카까지.xlsx
├── 거래처별_증빙유형_전표구분_신카까지.json
└── 인수인계_분석_YYYY_vXX.xlsx  (버전별)
```

---

## 요약.xlsx 시트 구조

| # | 시트명 | 내용 | 범위 |
|:-:|--------|------|------|
| 1 | 회사프로필 | 기본 정보 | A1:B12 |
| 2 | 손익검증 | 손익계산서 vs 분개장 비교 | A1:F9 |
| 3 | 월별손익 | 월별 손익 추이 | A1:N9 |
| 4 | 거래처별_증빙유형_전표구분_신카까지 | 상세 분석 | 가변 |

---

## 요약.json 구조

### 1. company_profile (회사 프로필)

```json
{
  "회사명": "더제이의원",
  "대표자": "김성철",
  "업종": "보건업",
  "업태": "피부과",
  "사업자등록번호": "2111050642",
  "사업시작일": "20140219",
  "주소": "서울특별시 강남구...",
  "관할세무서": "강남",
  "개인/법인": "개인",
  "주거래은행": "국민은행",
  "회사유형": "신용카드형"
}
```

**회사유형 판정 기준:**
| 조건 | 유형 |
|------|------|
| 자동전표-통장(90) ≥ 50% | 은행자동이체형 |
| 신용카드(88) ≥ 35% | 신용카드형 |
| 세금계산서(86) ≥ 30% | 세금계산서형 |

---

### 2. income_verification (손익 검증)

```json
{
  "매출액": {
    "손익계산서": 1016553997,
    "분개장": 1016553997
  },
  "매출원가": {
    "손익계산서": 214736084,
    "분개장_closing": 214736084,
    "분개장_immediate": 247030233,
    "재고변동": 32294149
  },
  "판관비": {
    "손익계산서": 617733914,
    "분개장": 617733914
  },
  "영업외수익": {...},
  "영업외비용": {...},
  "당기순이익": {...}
}
```

---

### 3. monthly_pl (월별 손익)

```json
{
  "1": {
    "매출액": 80322456,
    "매출원가": 5725384,
    "매출총이익": 74597072,
    "판관비": 47631240,
    "영업이익": 26965832,
    "영업외수익": 0,
    "영업외비용": 587408,
    "당기순이익": 26378424
  },
  "2": {...},
  ...
  "12": {...}
}
```

---

### 4. monthly_pl_trade_evidence_with_card (거래처별 상세)

```json
[
  {
    "카테고리": "매출",
    "계정코드": "41200",
    "계정과목": "보험의료수입",
    "거래처": "건강보험공단",
    "적요": "매출전표",
    "no_exter2": 0,
    "증빙유형명": "수기입력",
    "전표구분": "매입매출",
    "매입매출전표유형": "기타(20)",
    "클러스터": "0_매입매출",
    "1월": 0,
    "2월": 0,
    ...
    "12월": 7013955,
    "합계": 12956665
  }
]
```

**주요 컬럼:**
| 컬럼 | 설명 |
|------|------|
| 카테고리 | 매출/매출원가/판관비/영업외수익/영업외비용 |
| 계정코드 | 5자리 계정코드 |
| 거래처 | 거래처명 |
| no_exter2 | 증빙유형 코드 |
| 전표구분 | 일반/매입매출/신용카드 |
| 클러스터 | 분류 그룹 |
| 1월~12월 | 월별 금액 |
| 합계 | 연간 합계 |

---

## 활용 예시

```python
import json

with open('output/thej/요약.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

# 회사 유형 확인
print(data['company_profile']['회사유형'])  # 신용카드형

# 월별 매출 확인
for month, pl in data['monthly_pl'].items():
    print(f"{month}월: {pl['매출액']:,}원")
```
